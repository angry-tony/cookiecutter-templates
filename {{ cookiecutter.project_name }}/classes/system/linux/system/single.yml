classes:
- service.linux.system
- service.ntp.client
- service.salt.minion.master
- system.collectd.client.carbon
- system.sensu.client.single
- system.openssh.server.single
- system.openssh.server.team.tcpcloud
parameters:
  _param:

    # TODO, Configure linux.system.single
    #ntp_strata_host1: #TODO, configure ntp hosts
    #ntp_strata_host2: #TODO, acnfigure ntp hosts

  linux:
    system:
      package:
        cloud-init:
          version: purged
      repo:
        tcpcloud:
          source: "deb [arch=amd64] {{ cookiecutter.apt_repository }}/{{ cookiecutter.apt_branch }}/ trusty main security extra tcp tcp-salt {{ cookiecutter.openstack_version }} oc{{cookiecutter.opencontrail_version|replace('.', '') }} galera-s9s"
          architectures: amd64
          default: true
          key_url: "{{ cookiecutter.apt_repository }}/public.gpg"
    network:
      #resolv:
      #  dns:
      #    - {{cookiecutter.network_underlay_dns1}}
      #    - {{cookiecutter.network_underlay_dns2}}
      #  domain: {{cookiecutter.domain_name}}
      #  search:
      #    - {{cookiecutter.domain_name}}
      host:
    {%- for node in cookiecutter.keys()|sort %}
      {%- if node[5:] == '_ip' %}
        {{ cookiecutter[node[:-3]+'_name'] }}:
          name: {{ node[:-3] }}
          address: {{ cookiecutter[node] }}
          names:
            - {{ cookiecutter[node[:-3]+'_name'] }}.{{ cookiecutter.domain_name }}
            - {{ cookiecutter[node[:-3]+'_name'] }}
      {%- endif %}
    {%- endfor %}
