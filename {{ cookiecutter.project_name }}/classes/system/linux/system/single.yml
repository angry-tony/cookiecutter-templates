classes:
- service.linux.system
- service.ntp.client
- service.salt.minion.master
- system.linux.repo.openstack
- system.collectd.client.carbon
- system.sensu.client.single
- system.openssh.server.single
- system.openssh.server.team.tcpcloud
parameters:
  #_param:
    # TODO, configure ntp hosts if default formula metadata: ntp.cesnet.cz and pool.ntp.org does not fit
    # ntp_strata_host1: ntp.cesnet.cz
    # ntp_strata_host2: pool.ntp.org
  linux:
    system:
      package:
        cloud-init:
          version: purged
    network:
      #resolv:
      #  dns:
      #    - {{cookiecutter.network_underlay_dns1}}
      #    - {{cookiecutter.network_underlay_dns2}}
      #  domain: {{cookiecutter.domain_name}}
      #  search:
      #    - {{cookiecutter.domain_name}}
      host:
    {%- for node in cookiecutter.keys()|sort %}
      {%- if node[5:] == '_ip' and cookiecutter[node] != "" %}
        {{ cookiecutter[node[:-3]+'_name'] }}:
          name: {{ node[:-3] }}
          address: {{ cookiecutter[node] }}
          names:
            - {{ cookiecutter[node[:-3]+'_name'] }}.{{ cookiecutter.domain_name }}
            - {{ cookiecutter[node[:-3]+'_name'] }}
      {%- endif %}
    {%- endfor %}
        keystone:
          name: keystone
          address: ${_param:control_vip_address}
          names:
            - keystone
        proxy_vip:
          address: ${_param:proxy_vip_address}
          names:
          - ${_param:cluster_public_host}
