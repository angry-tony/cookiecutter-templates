# Address plan covered at:
# https://docs.google.com/spreadsheets/d/17jhct4awbaoXVKp7_SdCbS-DBlikB6oEMb3gzLI4By8/edit#gid=0
classes:
- system.linux.system.single
- system.openssh.server.team.tcpcloud
- system.openssh.server.team.mmo_devops
- cluster.{{ cookiecutter.cluster_name }}.infra
- cluster.{{ cookiecutter.cluster_name }}.openstack
- cluster.{{ cookiecutter.cluster_name }}.stacklight
- cluster.{{ cookiecutter.cluster_name }}.stacklight.client
parameters:
  _param:
    openstack_version: {{ cookiecutter.openstack_version }}
    cluster_domain: {{ cookiecutter.cluster_domain }}
    stacklight_environment: ${_param:cluster_domain}
    reclass_data_revision: master
    cluster_name: {{ cookiecutter.cluster_name }}
    cluster_public_host: {{ cookiecutter.public_host }}
    infra_config_hostname: {{ cookiecutter.salt_master_hostname }}
    ##local repositiry for aptly
    #local_repo_url: ip_address
    #linux_repo_refresh_db: True

    # infra service addresses
    infra_config_address: {{ cookiecutter.salt_master_ip }}
    infra_config_deploy_address: {{ cookiecutter.salt_master_management_ip }}

    openstack_gateway_node01_address: {{ cookiecutter.openstack_gateway_node01_address }}
    openstack_gateway_node02_address: {{ cookiecutter.openstack_gateway_node02_address }}
    openstack_gateway_node03_address: {{ cookiecutter.openstack_gateway_node03_address }}
    openstack_gateway_node01_tenant_address: {{ cookiecutter.openstack_gateway_node01_tenant_address }}
    openstack_gateway_node02_tenant_address: {{ cookiecutter.openstack_gateway_node02_tenant_address }}
    openstack_gateway_node03_tenant_address: {{ cookiecutter.openstack_gateway_node03_tenant_address }}
    openstack_gateway_node01_hostname: {{ cookiecutter.openstack_gateway_node01_hostname }}
    openstack_gateway_node02_hostname: {{ cookiecutter.openstack_gateway_node02_hostname }}
    openstack_gateway_node03_hostname: {{ cookiecutter.openstack_gateway_node03_hostname }}

    infra_kvm_address: {{ cookiecutter.kvm_vip_ip }}
    infra_kvm_node01_address: {{ cookiecutter.kvm01_control_ip }}
    infra_kvm_node02_address: {{ cookiecutter.kvm02_control_ip }}
    infra_kvm_node03_address: {{ cookiecutter.kvm03_control_ip }}
    infra_kvm_node01_deploy_address: {{ cookiecutter.kvm01_deploy_ip }}
    infra_kvm_node02_deploy_address: {{ cookiecutter.kvm02_deploy_ip }}
    infra_kvm_node03_deploy_address: {{ cookiecutter.kvm03_deploy_ip }}
    infra_kvm_node01_hostname: {{ cookiecutter.kvm01_name }}
    infra_kvm_node02_hostname: {{ cookiecutter.kvm02_name }}
    infra_kvm_node03_hostname: {{ cookiecutter.kvm03_name }}

    # openstack service addresses
    openstack_proxy_address: {{ cookiecutter.openstack_proxy_address }}
    openstack_proxy_node01_address: {{ cookiecutter.openstack_proxy_node01_address }}
    openstack_proxy_node02_address: {{ cookiecutter.openstack_proxy_node02_address }}
    openstack_control_address: {{ cookiecutter.openstack_control_address }}
    openstack_control_node01_address: {{ cookiecutter.openstack_control_node01_address }}
    openstack_control_node02_address: {{ cookiecutter.openstack_control_node02_address }}
    openstack_control_node03_address: {{ cookiecutter.openstack_control_node03_address }}
    openstack_database_address: {{ cookiecutter.openstack_database_address }}
    openstack_database_node01_address: {{ cookiecutter.openstack_database_node01_address }}
    openstack_database_node02_address: {{ cookiecutter.openstack_database_node02_address }}
    openstack_database_node03_address: {{ cookiecutter.openstack_database_node03_address }}
    openstack_message_queue_address: {{ cookiecutter.openstack_message_queue_address }}
    openstack_message_queue_node01_address: {{ cookiecutter.openstack_message_queue_node01_address }}
    openstack_message_queue_node02_address: {{ cookiecutter.openstack_message_queue_node02_address }}
    openstack_message_queue_node03_address: {{ cookiecutter.openstack_message_queue_node03_address }}

    openstack_telemetry_hostname: {{ cookiecutter.openstack_telemetry_hostname }}
    openstack_telemetry_node01_hostname: {{ cookiecutter.openstack_telemetry_node01_hostname }}
    openstack_telemetry_node02_hostname: {{ cookiecutter.openstack_telemetry_node02_hostname }}
    openstack_telemetry_node03_hostname: {{ cookiecutter.openstack_telemetry_node03_hostname }}

    # Billing
    # openstack_billing_address:

    # Stacklight Monitor
    stacklight_monitor_address: {{ cookiecutter.stacklight_monitor_address }}
    stacklight_monitor_node01_address: {{ cookiecutter.stacklight_monitor_node01_address }}
    stacklight_monitor_node02_address: {{ cookiecutter.stacklight_monitor_node02_address }}
    stacklight_monitor_node03_address: {{ cookiecutter.stacklight_monitor_node03_address }}
    stacklight_log_address: {{ cookiecutter.stacklight_log_address }}
    stacklight_log_node01_address: {{ cookiecutter.stacklight_log_node01_address }}
    stacklight_log_node02_address: {{ cookiecutter.stacklight_log_node02_address }}
    stacklight_log_node03_address: {{ cookiecutter.stacklight_log_node03_address }}
    stacklight_telemetry_address: {{ cookiecutter.stacklight_telemetry_address }}
    stacklight_telemetry_node01_address: {{ cookiecutter.stacklight_telemetry_node01_address }}
    stacklight_telemetry_node02_address: {{ cookiecutter.stacklight_telemetry_node02_address }}
    stacklight_telemetry_node03_address: {{ cookiecutter.stacklight_telemetry_node03_address }}

    # OpenStack Compute
    openstack_compute_node01_single_address: {{ cookiecutter.openstack_compute_node01_single_address }}
    openstack_compute_node02_single_address: {{ cookiecutter.openstack_compute_node02_single_address }}
    openstack_compute_node03_single_address: {{ cookiecutter.openstack_compute_node03_single_address }}
    openstack_compute_node01_control_address: {{ cookiecutter.openstack_compute_node01_control_address }}
    openstack_compute_node02_control_address: {{ cookiecutter.openstack_compute_node02_control_address }}
    openstack_compute_node03_control_address: {{ cookiecutter.openstack_compute_node03_control_address }}
    openstack_compute_node01_tenant_address: {{ cookiecutter.openstack_compute_node01_tenant_address }}
    openstack_compute_node02_tenant_address: {{ cookiecutter.openstack_compute_node02_tenant_address }}
    openstack_compute_node03_tenant_address: {{ cookiecutter.openstack_compute_node03_tenant_address }}


    # openstack service hostnames
    openstack_proxy_hostname: {{ cookiecutter.openstack_proxy_hostname }}
    openstack_proxy_node01_hostname: {{ cookiecutter.openstack_proxy_node01_hostname }}
    openstack_proxy_node02_hostname: {{ cookiecutter.openstack_proxy_node02_hostname }}
    openstack_control_hostname: {{ cookiecutter.openstack_control_hostname }}
    openstack_control_node01_hostname: {{ cookiecutter.openstack_control_node01_hostname }}
    openstack_control_node02_hostname: {{ cookiecutter.openstack_control_node02_hostname }}
    openstack_control_node03_hostname: {{ cookiecutter.openstack_control_node03_hostname }}
    openstack_database_hostname: {{ cookiecutter.openstack_database_hostname }}
    openstack_database_node01_hostname: {{ cookiecutter.openstack_database_node01_hostname }}
    openstack_database_node02_hostname: {{ cookiecutter.openstack_database_node02_hostname }}
    openstack_database_node03_hostname: {{ cookiecutter.openstack_database_node03_hostname }}
    openstack_message_queue_hostname: {{ cookiecutter.openstack_message_queue_hostname }}
    openstack_message_queue_node01_hostname: {{ cookiecutter.openstack_message_queue_node01_hostname }}
    openstack_message_queue_node02_hostname: {{ cookiecutter.openstack_message_queue_node02_hostname }}
    openstack_message_queue_node03_hostname: {{ cookiecutter.openstack_message_queue_node03_hostname }}
    openstack_telemetry_hostname: {{ cookiecutter.openstack_telemetry_hostname }}
    openstack_telemetry_node01_hostname: {{ cookiecutter.openstack_telemetry_node01_hostname }}
    openstack_telemetry_node02_hostname: {{ cookiecutter.openstack_telemetry_node02_hostname }}
    openstack_telemetry_node03_hostname: {{ cookiecutter.openstack_telemetry_node03_hostname }}

    # stacklight service hostnames
    stacklight_monitor_hostname: {{ cookiecutter.stacklight_monitor_hostname }}
    stacklight_monitor_node01_hostname: {{ cookiecutter.stacklight_monitor_node01_hostname }}
    stacklight_monitor_node02_hostname: {{ cookiecutter.stacklight_monitor_node02_hostname }}
    stacklight_monitor_node03_hostname: {{ cookiecutter.stacklight_monitor_node03_hostname }}
    stacklight_log_hostname: {{ cookiecutter.stacklight_log_hostname }}
    stacklight_log_node01_hostname: {{ cookiecutter.stacklight_log_node01_hostname }}
    stacklight_log_node02_hostname: {{ cookiecutter.stacklight_log_node02_hostname }}
    stacklight_log_node03_hostname: {{ cookiecutter.stacklight_log_node03_hostname }}
    stacklight_telemetry_hostname: {{ cookiecutter.stacklight_telemetry_hostname }}
    stacklight_telemetry_node01_hostname: {{ cookiecutter.stacklight_telemetry_node01_hostname }}
    stacklight_telemetry_node02_hostname: {{ cookiecutter.stacklight_telemetry_node02_hostname }}
    stacklight_telemetry_node03_hostname: {{ cookiecutter.stacklight_telemetry_node03_hostname }}

    # openstack compute
    openstack_compute_node01_hostname: {{ cookiecutter.openstack_compute_node01_hostname }}
    openstack_compute_node02_hostname: {{ cookiecutter.openstack_compute_node02_hostname }}
    openstack_compute_node03_hostname: {{ cookiecutter.openstack_compute_node03_hostname }}


    ##CI/CD
    #infra_integration_node01_single_address:
    #infra_version_control_node01_single_address:
    #infra_storage_node01_single_address:
    #infra_benchmark_node01_single_address:

    ##FIXME if ntp defined
    #ntp_strata_host1:
    #ntp_strata_host2:

    # Interface definitions
    linux_dhcp_interface:
      enabled: true
      type: eth
      proto: dhcp
    linux_single_interface:
      enabled: true
      type: eth
      proto: static
      address: ${_param:single_address}
      netmask: {{ cookiecutter.control_network_netmask }}
      gateway: {{ cookiecutter.control_network_gateway }}
      name_servers:
        - {{ cookiecutter.dns_server01 }}
        - {{ cookiecutter.dns_server02 }}
